{
  "openapi": "3.0.0",
  "info": {
    "title": "SFMC Journey Inspector API (Sandbox, Read-only)",
    "version": "1.1.0",
    "description": "Action group for searching and inspecting Salesforce Marketing Cloud (SFMC) Journey Builder journeys in a SANDBOX. Read-only only: no sends, no writes, no event firing, no journey activation."
  },
  "paths": {
    "/searchJourneys": {
      "post": {
        "summary": "Search journeys (Journey Builder REST)",
        "description": "Search Journey Builder journeys in sandbox. Read-only. pageSize may be clamped by the backend for safety and API limits.",
        "operationId": "searchJourneys",
        "x-requireConfirmation": "DISABLED",
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "nameOrDescription": { "type": "string" },
                  "status": { "type": "string" },
                  "id": { "type": "string", "description": "If provided, searches by journey id. Some SFMC tenants return all versions for an id." },
                  "key": { "type": "string", "description": "If provided, searches by journey key." },
                  "mostRecentVersionOnly": { "type": "boolean", "default": true },
                  "extras": {
                    "type": "string",
                    "description": "Optional extras hint (e.g., 'activities', 'stats', 'outcome'). Backend may restrict or ignore."
                  },
                  "page": { "type": "integer", "minimum": 1, "default": 1 },
                  "pageSize": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 999,
                    "default": 25,
                    "description": "Requested pageSize. Backend clamps to API max and safety limits."
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Journey search results" },
          "400": { "description": "Bad request" },
          "500": { "description": "Internal error" }
        }
      }
    },

    "/getJourney": {
      "post": {
        "summary": "Get a journey by id or key (Journey Builder REST)",
        "description": "Fetch a single journey (optionally a specific version) by id or by key. For key lookup, prefix idOrKey with 'key:'. Read-only.",
        "operationId": "getJourney",
        "x-requireConfirmation": "DISABLED",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["idOrKey"],
                "properties": {
                  "idOrKey": {
                    "type": "string",
                    "description": "Journey id (GUID) OR 'key:<journeyKey>'"
                  },
                  "versionNumber": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Optional versionNumber."
                  },
                  "extras": {
                    "type": "string",
                    "description": "Optional extras hint (e.g., 'activities', 'stats', 'outcome'). Backend may restrict or ignore."
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Journey detail" },
          "404": { "description": "Not found" },
          "400": { "description": "Bad request" },
          "500": { "description": "Internal error" }
        }
      }
    },

    "/listJourneyVersions": {
      "post": {
        "summary": "List journey versions (derived from search results)",
        "description": "List all known versions for a journey id or key. Read-only.",
        "operationId": "listJourneyVersions",
        "x-requireConfirmation": "DISABLED",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["idOrKey"],
                "properties": {
                  "idOrKey": {
                    "type": "string",
                    "description": "Journey id (GUID) OR 'key:<journeyKey>'"
                  },
                  "pageSize": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 999,
                    "default": 50,
                    "description": "Requested pageSize for underlying search. Backend clamps."
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Journey versions list" },
          "404": { "description": "Not found" },
          "400": { "description": "Bad request" },
          "500": { "description": "Internal error" }
        }
      }
    },

    "/getJourneyAuditLog": {
      "post": {
        "summary": "Get journey audit log (Journey Builder REST)",
        "description": "Return audit trail for a journey id or key. If key is provided, backend resolves id first via getJourney. Read-only.",
        "operationId": "getJourneyAuditLog",
        "x-requireConfirmation": "DISABLED",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["idOrKey"],
                "properties": {
                  "idOrKey": {
                    "type": "string",
                    "description": "Journey id (GUID) OR 'key:<journeyKey>'"
                  },
                  "action": {
                    "type": "string",
                    "enum": ["all", "create", "modify", "activate", "deactivate", "stop", "delete"],
                    "default": "all"
                  },
                  "page": { "type": "integer", "minimum": 1, "default": 1 },
                  "pageSize": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 999,
                    "default": 50,
                    "description": "Requested pageSize. Backend clamps."
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Audit log" },
          "404": { "description": "Not found" },
          "400": { "description": "Bad request" },
          "500": { "description": "Internal error" }
        }
      }
    },

    "/summarizeJourney": {
      "post": {
        "summary": "Summarize a journey (activities/triggers overview)",
        "description": "Returns a compact, Bedrock-safe summary: counts by activity type, entry sources, comms/decision/wait lists (truncated), plus best-effort reference keys.",
        "operationId": "summarizeJourney",
        "x-requireConfirmation": "DISABLED",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["idOrKey"],
                "properties": {
                  "idOrKey": { "type": "string", "description": "Journey id (GUID) OR 'key:<journeyKey>'" },
                  "versionNumber": { "type": "integer", "minimum": 1 },
                  "extras": {
                    "type": "string",
                    "default": "activities",
                    "description": "Optional extras hint; backend will generally need 'activities' to summarize."
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Journey summary" },
          "404": { "description": "Not found" },
          "400": { "description": "Bad request" },
          "500": { "description": "Internal error" }
        }
      }
    },

    "/journeyTopology": {
      "post": {
        "summary": "Build a journey topology graph (nodes + edges)",
        "description": "Returns a compact graph derived from activities[].outcomes[].next, capped by backend limits. Includes basic metrics and start-candidate keys.",
        "operationId": "journeyTopology",
        "x-requireConfirmation": "DISABLED",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["idOrKey"],
                "properties": {
                  "idOrKey": { "type": "string", "description": "Journey id (GUID) OR 'key:<journeyKey>'" },
                  "versionNumber": { "type": "integer", "minimum": 1 },
                  "extras": {
                    "type": "string",
                    "default": "activities",
                    "description": "Optional extras hint; backend will generally need 'activities' to build topology."
                  },
                  "maxNodes": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5000,
                    "description": "Requested max nodes. Backend clamps to TOPOLOGY_MAX_NODES."
                  },
                  "maxEdges": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 20000,
                    "description": "Requested max edges. Backend clamps to TOPOLOGY_MAX_EDGES."
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Journey topology graph" },
          "404": { "description": "Not found" },
          "400": { "description": "Bad request" },
          "500": { "description": "Internal error" }
        }
      }
    }
  }
}